/**
 * @preserve Copyright (c) 2014 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:</p>
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */
!function(n){"object"==typeof exports?module.exports=n():"function"==typeof define&&define.amd?define(n):"undefined"!=typeof window?window.Promise=n():"undefined"!=typeof global?global.Promise=n():"undefined"!=typeof self&&(self.Promise=n())}(function(){return function n(t,i,r){function u(f,o){var h,s;if(!i[f]){if(!t[f]){if(h=typeof require=="function"&&require,!o&&h)return h(f,!0);if(e)return e(f,!0);throw new Error("Cannot find module '"+f+"'");}s=i[f]={exports:{}};t[f][0].call(s.exports,function(n){var i=t[f][1][n];return u(i?i:n)},s,s.exports,n,t,i,r)}return i[f].exports}for(var e=typeof require=="function"&&require,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(n,t){"use strict";t.exports=function(n){function t(n){var t=new i(n),r=t.promise();return r.isRejected()?r:(t.setHowMany(1),t.setUnwrap(),t.init(),r)}var i=n._SomePromiseArray;n.any=function(n){return t(n)};n.prototype.any=function(){return t(this)}}},{}],2:[function(n,t){"use strict";function i(){this._isTickUsed=!1;this._schedule=f;this._length=0;this._lateBuffer=new u(16);this._functionBuffer=new u(65536);var n=this;this.consumeFunctionBuffer=function(){n._consumeFunctionBuffer()}}var f=n("./schedule.js"),u=n("./queue.js"),e=n("./util.js").errorObj,o=n("./util.js").tryCatch1,r=typeof process!="undefined"?process:void 0;i.prototype.haveItemsQueued=function(){return this._length>0};i.prototype.invokeLater=function(n,t,i){r===void 0||r.domain==null||n.domain||(n=r.domain.bind(n));this._lateBuffer.push(n,t,i);this._queueTick()};i.prototype.invoke=function(n,t,i){r===void 0||r.domain==null||n.domain||(n=r.domain.bind(n));var u=this._functionBuffer;u.push(n,t,i);this._length=u.length();this._queueTick()};i.prototype._consumeFunctionBuffer=function(){for(var n=this._functionBuffer;n.length()>0;){var t=n.shift(),i=n.shift(),r=n.shift();t.call(i,r)}this._reset();this._consumeLateBuffer()};i.prototype._consumeLateBuffer=function(){for(var n=this._lateBuffer;n.length()>0;){var t=n.shift(),r=n.shift(),u=n.shift(),i=o(t,r,u);if(i===e)if(this._queueTick(),t.domain!=null)t.domain.emit("error",i.e);else throw i.e;}};i.prototype._queueTick=function(){this._isTickUsed||(this._schedule(this.consumeFunctionBuffer),this._isTickUsed=!0)};i.prototype._reset=function(){this._isTickUsed=!1;this._length=0};t.exports=new i},{"./queue.js":25,"./schedule.js":28,"./util.js":35}],3:[function(n,t){"use strict";var i=n("./promise.js")();t.exports=i},{"./promise.js":20}],4:[function(n,t){"use strict";var i=Object.create,r,u;i&&(r=i(null),u=i(null),r[" size"]=u[" size"]=0);t.exports=function(t){function h(n){return new Function("obj","                                             \n        'use strict'                                                         \n        var len = this.length;                                               \n        switch(len) {                                                        \n            case 1: return obj.methodName(this[0]);                          \n            case 2: return obj.methodName(this[0], this[1]);                 \n            case 3: return obj.methodName(this[0], this[1], this[2]);        \n            case 0: return obj.methodName();                                 \n            default: return obj.methodName.apply(obj, this);                 \n        }                                                                    \n        ".replace(/methodName/g,n))}function c(n){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",n))}function e(n,t,i){var r=i[n],f,u;if(typeof r!="function"){if(!s(n))return null;if(r=t(n),i[n]=r,i[" size"]++,i[" size"]>512){for(f=Object.keys(i),u=0;u<256;++u)delete i[f[u]];i[" size"]=f.length-256}}return r}function l(n){return e(n,h,r)}function a(n){return e(n,c,u)}function v(n){return n[this.pop()].apply(n,this)}function o(n){return n[this]}function y(n){return n[this]}var i=n("./util.js"),f=i.canEvaluate,s=i.isIdentifier;t.prototype.call=function(n){for(var r,u=arguments.length,t=new Array(u-1),i=1;i<u;++i)t[i-1]=arguments[i];return f&&(r=l(n),r!==null)?this._then(r,void 0,void 0,t,void 0):(t.push(n),this._then(v,void 0,void 0,t,void 0))};t.prototype.get=function(n){var r=typeof n=="number",t,i;return r?t=y:f?(i=a(n),t=i!==null?i:o):t=o,this._then(t,void 0,void 0,n,void 0)}}},{"./util.js":35}],5:[function(n,t){"use strict";t.exports=function(t,i){var r=n("./errors.js"),u=r.canAttach,f=n("./async.js"),e=r.CancellationError;t.prototype._cancel=function(n){if(!this.isCancellable())return this;for(var i,t=this;(i=t._cancellationParent)!==void 0&&i.isCancellable();)t=i;t._attachExtraTrace(n);t._rejectUnchecked(n)};t.prototype.cancel=function(n){return this.isCancellable()?(n=n!==void 0?u(n)?n:new Error(n+""):new e,f.invokeLater(this._cancel,this,n),this):this};t.prototype.cancellable=function(){return this._cancellable()?this:(this._setCancellable(),this._cancellationParent=void 0,this)};t.prototype.uncancellable=function(){var n=new t(i);return n._propagateFrom(this,6),n._follow(this),n._unsetCancellable(),n};t.prototype.fork=function(n,t,i){var r=this._then(n,t,i,void 0,void 0);return r._setCancellable(),r._cancellationParent=void 0,r}}},{"./async.js":2,"./errors.js":10}],6:[function(n,t){"use strict";t.exports=function(){function u(n){var t,i,r;if(typeof n=="function")t="[function "+(n.name||"anonymous")+"]";else{if(t=n.toString(),i=/\[object [a-zA-Z0-9$_]+\]/,i.test(t))try{r=JSON.stringify(n);t=r}catch(u){}t.length===0&&(t="(empty array)")}return"(<"+h(t)+">, no stack trace)"}function h(n){var t=41;return n.length<t?n:n.substr(0,t-3)+"..."}function t(n,i){this.captureStackTrace(t,i)}var e=n("./util.js").inherits,o=n("./es5.js").defineProperty,s=new RegExp("\\b(?:[a-zA-Z0-9.]+\\$_\\w+|tryCatch(?:1|2|3|4|Apply)|new \\w*PromiseArray|\\w*PromiseArray\\.\\w*PromiseArray|setTimeout|CatchFilter\\$_\\w+|makeNodePromisified|processImmediate|process._tickCallback|nextTick|Async\\$\\w+)\\b"),i=null,r=null,f;return e(t,Error),t.prototype.captureStackTrace=function(n,t){f(this,n,t)},t.possiblyUnhandledRejection=function(n){var t,i;typeof console=="object"&&(typeof n=="object"||typeof n=="function"?(i=n.stack,t="Possibly unhandled "+r(i,n)):t="Possibly unhandled "+String(n),typeof console.error=="function"||typeof console.error=="object"?console.error(t):(typeof console.log=="function"||typeof console.log=="object")&&console.log(t))},t.combine=function(n,t){for(var o,u,f,h,e=n.length-1,r=t.length-1;r>=0;--r)if(o=t[r],n[e]===o)n.pop(),e--;else break;for(n.push("From previous event:"),u=n.concat(t),f=[],r=0,h=u.length;r<h;++r)s.test(u[r])&&i.test(u[r])||r>0&&!i.test(u[r])&&u[r]!=="From previous event:"||f.push(u[r]);return f},t.protectErrorMessageNewlines=function(n){for(var r,u,t=0;t<n.length;++t)if(i.test(n[t]))break;if(!(t<=1)){for(r=[],u=0;u<t;++u)r.push(n.shift());n.unshift(r.join("\x02\x00\x01"))}},t.isSupported=function(){return typeof f=="function"},f=function c(){var t,n,f;return typeof Error.stackTraceLimit=="number"&&typeof Error.captureStackTrace=="function"?(i=/^\s*at\s*/,r=function(n,t){return typeof n=="string"?n:t.name!==void 0&&t.message!==void 0?t.name+". "+t.message:u(t)},t=Error.captureStackTrace,function(n,i){t(n,i)}):(n=new Error,typeof n.stack=="string"&&typeof"".startsWith=="function"&&n.stack.startsWith("stackDetection@")&&c.name==="stackDetection"?(o(Error,"stackTraceLimit",{writable:!0,enumerable:!1,configurable:!1,value:25}),i=/@/,f=/[@\n]/,r=function(n,t){return typeof n=="string"?t.name+". "+t.message+"\n"+n:t.name!==void 0&&t.message!==void 0?t.name+". "+t.message:u(t)},function(n){for(var u=(new Error).stack,r=u.split(f),e=r.length,t="",i=0;i<e;i+=2)t+=r[i],t+="@",t+=r[i+1],t+="\n";n.stack=t}):(r=function(n,t){return typeof n=="string"?n:(typeof t=="object"||typeof t=="function")&&t.name!==void 0&&t.message!==void 0?t.name+". "+t.message:u(t)},null))}(),t}},{"./es5.js":12,"./util.js":35}],7:[function(n,t){"use strict";t.exports=function(t){function e(n,t,i){this._instances=n;this._callback=t;this._promise=i}function h(n,t){var f={},u=r(n,f,t),e;return u===i?u:(e=o(f),e.length)?(i.e=new s("Catch filter must inherit from Error or be a simple predicate function"),i):u}var u=n("./util.js"),f=n("./errors.js"),r=u.tryCatch1,i=u.errorObj,o=n("./es5.js").keys,s=f.TypeError;return e.prototype.doFilter=function(n){for(var e,s,c,v,u,l=this._callback,y=this._promise,a=y._boundTo,o=0,p=this._instances.length;o<p;++o){if(e=this._instances[o],s=e===Error||e!=null&&e.prototype instanceof Error,s&&n instanceof e)return(u=r(l,a,n),u===i)?(t.e=u.e,t):u;if(typeof e=="function"&&!s)if(c=h(e,n),c===i){v=f.canAttach(i.e)?i.e:new Error(i.e+"");this._promise._attachExtraTrace(v);n=i.e;break}else if(c)return(u=r(l,a,n),u===i)?(t.e=u.e,t):u}return t.e=n,t},e}},{"./errors.js":10,"./es5.js":12,"./util.js":35}],8:[function(n,t){"use strict";var i=n("./util.js"),r=i.isPrimitive,u=i.wrapsPrimitiveReceiver;t.exports=function(n){var i=function(){return this},f=function(){throw this;},t=function(n,t){return t===1?function(){throw n;}:t===2?function(){return n}:void 0};n.prototype["return"]=n.prototype.thenReturn=function(n){return u&&r(n)?this._then(t(n,2),void 0,void 0,void 0,void 0):this._then(i,void 0,void 0,n,void 0)};n.prototype["throw"]=n.prototype.thenThrow=function(n){return u&&r(n)?this._then(t(n,1),void 0,void 0,void 0,void 0):this._then(f,void 0,void 0,n,void 0)}}},{"./util.js":35}],9:[function(n,t){"use strict";t.exports=function(n,t){var i=n.reduce;n.prototype.each=function(n){return i(this,n,null,t)};n.each=function(n,r){return i(n,r,null,t)}}},{}],10:[function(n,t){"use strict";function w(n){try{y(n,"isOperational",!0)}catch(t){}}function b(n){return n==null?!1:n instanceof s||n.isOperational===!0}function k(n){return n instanceof Error}function d(n){return k(n)}function u(n,t){function i(r){if(!(this instanceof i))return new i(r);this.message=typeof r=="string"?r:t;this.name=n;Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}return v(i,Error),i}function s(n){this.name="OperationalError";this.message=n;this.cause=n;this.isOperational=!0;n instanceof Error?(this.message=n.message,this.stack=n.stack):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var p=n("./es5.js").freeze,a=n("./util.js"),v=a.inherits,y=a.notEnumerableProp,h,c,g=u("CancellationError","cancellation error"),nt=u("TimeoutError","timeout error"),f=u("AggregateError","aggregate error"),e,r,o,l,i;try{h=TypeError;c=RangeError}catch(tt){h=u("TypeError","type error");c=u("RangeError","range error")}for(e="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),r=0;r<e.length;++r)typeof Array.prototype[e[r]]=="function"&&(f.prototype[e[r]]=Array.prototype[e[r]]);f.prototype.length=0;f.prototype.isOperational=!0;o=0;f.prototype.toString=function(){var u=Array(o*4+1).join(" "),f="\n"+u+"AggregateError of:\n",n,r,t,i;for(o++,u=Array(o*4+1).join(" "),n=0;n<this.length;++n){for(r=this[n]===this?"[Circular AggregateError]":this[n]+"",t=r.split("\n"),i=0;i<t.length;++i)t[i]=u+t[i];r=t.join("\n");f+=r+"\n"}return o--,f};v(s,Error);l="__BluebirdErrorTypes__";i=Error[l];i||(i=p({CancellationError:g,TimeoutError:nt,OperationalError:s,RejectionError:s,AggregateError:f}),y(Error,l,i));t.exports={Error:Error,TypeError:h,RangeError:c,CancellationError:i.CancellationError,OperationalError:i.OperationalError,TimeoutError:i.TimeoutError,AggregateError:i.AggregateError,originatesFromRejection:b,markAsOriginatingFromRejection:w,canAttach:d}},{"./es5.js":12,"./util.js":35}],11:[function(n,t){"use strict";t.exports=function(t){function r(n){var r=new i(n),u=t.rejected(r),f=u._peekContext();return f!=null&&f._attachExtraTrace(r),u}var i=n("./errors.js").TypeError;return r}},{"./errors.js":10}],12:[function(n,t){var i=function(){"use strict";return this===void 0}();if(i)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,keys:Object.keys,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:i};else{var r={}.hasOwnProperty,u={}.toString,f={}.constructor.prototype,e=function(n){var t=[];for(var i in n)r.call(n,i)&&t.push(i);return t},o=function(n,t,i){return n[t]=i.value,n},s=function(n){return n},h=function(n){try{return Object(n).constructor.prototype}catch(t){return f}},c=function(n){try{return u.call(n)==="[object Array]"}catch(t){return!1}};t.exports={isArray:c,keys:e,defineProperty:o,freeze:s,getPrototypeOf:h,isES5:i}}},{}],13:[function(n,t){"use strict";t.exports=function(n,t){var i=n.map;n.prototype.filter=function(n,r){return i(this,n,r,t)};n.filter=function(n,r,u){return i(n,r,u,t)}}},{}],14:[function(n,t){"use strict";t.exports=function(t,i,r){function c(){return this}function l(){throw this;}function a(n){return function(){return n}}function v(n){return function(){throw n;}}function f(n,t,i){var r;return r=o&&s(t)?i?a(t):v(t):i?c:l,n._then(r,h,void 0,t,void 0)}function e(n){var u=this.promise,o=this.handler,s=u._isBound()?o.call(u._boundTo):o(),e;return s!==void 0&&(e=r(s,void 0),e instanceof t)?f(e,n,u.isFulfilled()):u.isRejected()?(i.e=n,i):n}function y(n){var u=this.promise,e=this.handler,o=u._isBound()?e.call(u._boundTo,n):e(n),i;return o!==void 0&&(i=r(o,void 0),i instanceof t)?f(i,n,!0):n}var u=n("./util.js"),o=u.wrapsPrimitiveReceiver,s=u.isPrimitive,h=u.thrower;t.prototype._passThroughHandler=function(n,t){if(typeof n!="function")return this.then();var i={promise:this,handler:n};return this._then(t?e:y,t?e:void 0,void 0,i,void 0)};t.prototype.lastly=t.prototype["finally"]=function(n){return this._passThroughHandler(n,!0)};t.prototype.tap=function(n){return this._passThroughHandler(n,!1)}}},{"./util.js":35}],15:[function(n,t){"use strict";t.exports=function(t,i,r,u){function a(n,i){for(var f,e,o=l,h=t,c=i.length,r=0;r<c;++r){if(f=s(i[r],void 0,n),f===o)return h.reject(o.e);if(e=u(f,a),e instanceof h)return e}return null}function f(n,i,u){var f=this._promise=new t(r);f._setTrace(void 0);this._generatorFunction=n;this._receiver=i;this._generator=void 0;this._yieldHandlers=typeof u=="function"?[u].concat(h):h}var e=n("./errors.js"),o=e.TypeError,v=n("./util.js").deprecated,c=n("./util.js"),l=c.errorObj,s=c.tryCatch1,h=[];f.prototype.promise=function(){return this._promise};f.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver);this._receiver=this._generatorFunction=void 0;this._next(void 0)};f.prototype._continue=function(n){var f,r,i;if(n===l){this._generator=void 0;f=e.canAttach(n.e)?n.e:new Error(n.e+"");this._promise._attachExtraTrace(f);this._promise._reject(n.e,f);return}if(r=n.value,n.done===!0)this._generator=void 0,this._promise._tryFollow(r)||this._promise._fulfill(r);else{if(i=u(r,void 0),!(i instanceof t)&&(i=a(i,this._yieldHandlers),i===null)){this._throw(new o("A value was yielded that could not be treated as a promise"));return}i._then(this._next,this._throw,void 0,this,null)}};f.prototype._throw=function(n){e.canAttach(n)&&this._promise._attachExtraTrace(n);this._continue(s(this._generator["throw"],this._generator,n))};f.prototype._next=function(n){this._continue(s(this._generator.next,this._generator,n))};t.coroutine=function(n,t){if(typeof n!="function")throw new o("generatorFunction must be a function");var i=Object(t).yieldHandler,r=f;return function(){var u=n.apply(this,arguments),t=new r(void 0,void 0,i);return t._generator=u,t._next(void 0),t.promise()}};t.coroutine.addYieldHandler=function(n){if(typeof n!="function")throw new o("fn must be a function");h.push(n)};t.spawn=function(n){if(v("Promise.spawn is deprecated. Use Promise.coroutine instead."),typeof n!="function")return i("generatorFunction must be a function");var r=new f(n,this),u=r.promise();return r._run(t.spawn),u}}},{"./errors.js":10,"./util.js":35}],16:[function(n,t){"use strict";t.exports=function(t,i,r,u){var o=n("./util.js"),s=o.canEvaluate,l=o.tryCatch1,a=o.errorObj,f,e;if(s){var v=function(n){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,n))},y=function(n){for(var i=[],t=1;t<=n;++t)i.push("holder.p"+t);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,i.join(", ")))},h=[],c=[void 0];for(f=1;f<=5;++f)h.push(v(f)),c.push(y(f));e=function(n,t){this.p1=this.p2=this.p3=this.p4=this.p5=null;this.fn=t;this.total=n;this.now=0};e.prototype.callers=c;e.prototype.checkFulfillment=function(n){var i=this.now,r,u,t;i++;r=this.total;i>=r?(u=this.callers[r],t=l(u,void 0,this),t===a?n._rejectUnchecked(t.e):n._tryFollow(t)||n._fulfillUnchecked(t)):this.now=i}}t.join=function(){var c=arguments.length-1,a,o,f,p,w,l,n;if(c>0&&typeof arguments[c]=="function"&&(a=arguments[c],c<6&&s)){n=new t(u);n._setTrace(void 0);var v=new e(c,a),b=n._reject,y=h;for(o=0;o<c;++o)f=r(arguments[o],void 0),f instanceof t?f.isPending()?f._then(y[o],b,void 0,n,v):f.isFulfilled()?y[o].call(n,f._settledValue,v):(n._reject(f._settledValue),f._unsetRejectionIsUnhandled()):y[o].call(n,f,v);return n}for(p=arguments.length,w=new Array(p),l=0;l<p;++l)w[l]=arguments[l];return n=new i(w).promise(),a!==void 0?n.spread(a):n}}},{"./util.js":35}],17:[function(n,t){"use strict";t.exports=function(t,i,r,u,f){function e(n,t,i,r){this.constructor$(n);this._callback=t;this._preservedValues=r===f?new Array(this.length()):null;this._limit=i;this._inFlight=0;this._queue=i>=1?[]:a;this._init$(void 0,-2)}function h(n,t,i,r){var u=typeof i=="object"&&i!==null?i.concurrency:0;return u=typeof u=="number"&&isFinite(u)&&u>=1?u:0,new e(n,t,u,r)}var o=n("./util.js"),c=o.tryCatch3,l=o.errorObj,s={},a=[];o.inherits(e,i);e.prototype._init=function(){};e.prototype._promiseFulfilled=function(n,i){var r=this._values,f,v;if(r!==null){var a=this.length(),o=this._preservedValues,h=this._limit;if(r[i]===s){if(r[i]=n,h>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(h>=1&&this._inFlight>=h){r[i]=n;this._queue.push(i);return}o!==null&&(o[i]=n);var y=this._callback,p=this._promise._boundTo,e=c(y,p,n,i,a);if(e===l)return this._reject(e.e);if(f=u(e,void 0),f instanceof t){if(f.isPending())return h>=1&&this._inFlight++,r[i]=s,f._proxyPromiseArray(this,i);if(f.isFulfilled())e=f.value();else return f._unsetRejectionIsUnhandled(),this._reject(f.reason())}r[i]=e}v=++this._totalResolved;v>=a&&(o!==null?this._filter(r,o):this._resolve(r))}};e.prototype._drainQueue=function(){for(var t=this._queue,i=this._limit,r=this._values,n;t.length>0&&this._inFlight<i;)n=t.pop(),this._promiseFulfilled(r[n],n)};e.prototype._filter=function(n,t){for(var u=t.length,r=new Array(u),f=0,i=0;i<u;++i)n[i]&&(r[f++]=t[i]);r.length=f;this._resolve(r)};e.prototype.preservedValues=function(){return this._preservedValues};t.prototype.map=function(n,t){return typeof n!="function"?r("fn must be a function"):h(this,n,t,null).promise()};t.map=function(n,t,i,u){return typeof t!="function"?r("fn must be a function"):h(n,t,i,u).promise()}}},{"./util.js":35}],18:[function(n,t){"use strict";t.exports=function(t){function f(n){throw n;}function h(n,t){if(!i.isArray(n))return o(n,t);var e=i.tryCatchApply(this,[null].concat(n),t);e===u&&r.invokeLater(f,void 0,e.e)}function o(n,t){var i=this,o=n===void 0?e(i,t,null):s(i,t,null,n);o===u&&r.invokeLater(f,void 0,o.e)}function c(n,t){var o=this,i=e(o,t,n);i===u&&r.invokeLater(f,void 0,i.e)}var i=n("./util.js"),r=n("./async.js"),s=i.tryCatch2,e=i.tryCatch1,u=i.errorObj;t.prototype.nodeify=function(n,t){if(typeof n=="function"){var i=o;t!==void 0&&Object(t).spread&&(i=h);this._then(i,c,void 0,n,this._boundTo)}return this}}},{"./async.js":2,"./util.js":35}],19:[function(n,t){"use strict";t.exports=function(t,i){var r=n("./util.js"),u=n("./async.js"),f=n("./errors.js"),e=r.tryCatch1,o=r.errorObj;t.prototype.progressed=function(n){return this._then(void 0,void 0,n,void 0,void 0)};t.prototype._progress=function(n){this._isFollowingOrFulfilledOrRejected()||this._progressUnchecked(n)};t.prototype._clearFirstHandlerData$Base=t.prototype._clearFirstHandlerData;t.prototype._clearFirstHandlerData=function(){this._clearFirstHandlerData$Base();this._progressHandler0=void 0};t.prototype._progressHandlerAt=function(n){return n===0?this._progressHandler0:this[(n<<2)+n-3]};t.prototype._doProgressWith=function(n){var s=n.value,h=n.handler,r=n.promise,c=n.receiver,i=e(h,c,s),u;i===o?i.e!=null&&i.e.name!=="StopProgressPropagation"&&(u=f.canAttach(i.e)?i.e:new Error(i.e+""),r._attachExtraTrace(u),r._progress(i.e)):i instanceof t?i._then(r._progress,null,null,r,void 0):r._progress(i)};t.prototype._progressUnchecked=function(n){var s,h,r,o,e,f;if(this.isPending())for(s=this._length(),h=this._progress,r=0;r<s;r++){if(o=this._progressHandlerAt(r),e=this._promiseAt(r),!(e instanceof t)){f=this._receiverAt(r);typeof o=="function"?o.call(f,n,e):f instanceof t&&f._isProxied()?f._progressUnchecked(n):f instanceof i&&f._promiseProgressed(n,e);continue}typeof o=="function"?u.invoke(this._doProgressWith,this,{handler:o,promise:e,receiver:this._receiverAt(r),value:n}):u.invoke(h,e,n)}}}},{"./async.js":2,"./errors.js":10,"./util.js":35}],20:[function(n,t){"use strict";function r(n){try{Promise===n&&(Promise=i)}catch(t){}return n}var i;typeof Promise!="undefined"&&(i=Promise);t.exports=function(){function t(n){if(typeof n!="function")throw new l("the promise constructor requires a resolver function");if(this.constructor!==t)throw new l("the promise constructor cannot be invoked directly");this._bitField=0;this._fulfillmentHandler0=void 0;this._rejectionHandler0=void 0;this._promise0=void 0;this._receiver0=void 0;this._settledValue=void 0;this._boundTo=void 0;n!==i&&this._resolveFromResolver(n)}function at(n){return n[0]}var c=n("./util.js"),s=n("./async.js"),h=n("./errors.js"),i=function(){},k={},p={e:null},u=n("./thenables.js")(t,i),f=n("./promise_array.js")(t,i,u),o=n("./captured_trace.js")(),ft=n("./catch_filter.js")(p),et=n("./promise_resolver.js"),tt=c.isArray,d=c.errorObj,w=c.tryCatch1,it=c.tryCatch2,g=c.tryCatchApply,ot=h.RangeError,l=h.TypeError,st=h.CancellationError,ht=h.TimeoutError,rt=h.OperationalError,ct=h.originatesFromRejection,ut=h.markAsOriginatingFromRejection,a=h.canAttach,lt=c.thrower,v=n("./errors_api_rejection")(t),b=function(){return new l("circular promise resolution chain")},nt,e,y;return t.prototype.bind=function(n){var f=u(n,void 0),r=new t(i),e,o;return f instanceof t?(e=f.then(function(n){r._setBoundTo(n)}),o=t.all([this,e]).then(at),r._follow(o)):(r._follow(this),r._setBoundTo(n)),r._propagateFrom(this,3),r},t.prototype.toString=function(){return"[object Promise]"},t.prototype.caught=t.prototype["catch"]=function(n){var u=arguments.length,r,f,i,e,o,s;if(u>1){for(r=new Array(u-1),f=0,i=0;i<u-1;++i)if(e=arguments[i],typeof e=="function")r[f++]=e;else return o=new l("A catch filter must be an error constructor or a filter function"),this._attachExtraTrace(o),t.reject(o);return r.length=f,n=arguments[i],this._resetTrace(),s=new ft(r,n,this),this._then(void 0,s.doFilter,void 0,s,void 0)}return this._then(void 0,n,void 0,void 0,void 0)},t.prototype.then=function(n,t,i){return this._then(n,t,i,void 0,void 0)},t.prototype.done=function(n,t,i){var r=this._then(n,t,i,void 0,void 0);r._setIsFinal()},t.prototype.spread=function(n,t){return this._then(n,t,void 0,k,void 0)},t.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},t.prototype.toJSON=function(){var n={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(n.fulfillmentValue=this._settledValue,n.isFulfilled=!0):this.isRejected()&&(n.rejectionReason=this._settledValue,n.isRejected=!0),n},t.prototype.all=function(){return new f(this).promise()},t.is=function(n){return n instanceof t},t.all=function(n){return new f(n).promise()},t.prototype.error=function(n){return this.caught(ct,n)},t.prototype._resolveFromSyncValue=function(n){if(n===d)this._cleanValues(),this._setRejected(),this._settledValue=n.e,this._ensurePossibleRejectionHandled();else{var i=u(n,void 0);i instanceof t?this._follow(i):(this._cleanValues(),this._setFulfilled(),this._settledValue=n)}},t.method=function(n){if(typeof n!="function")throw new l("fn must be a function");return function(){var r,e,o,u,f;switch(arguments.length){case 0:r=w(n,this,void 0);break;case 1:r=w(n,this,arguments[0]);break;case 2:r=it(n,this,arguments[0],arguments[1]);break;default:for(e=arguments.length,o=new Array(e),u=0;u<e;++u)o[u]=arguments[u];r=g(n,o,this)}return f=new t(i),f._setTrace(void 0),f._resolveFromSyncValue(r),f}},t.attempt=t["try"]=function(n,r,u){if(typeof n!="function")return v("fn must be a function");var e=tt(r)?g(n,r,u):w(n,u,r),f=new t(i);return f._setTrace(void 0),f._resolveFromSyncValue(e),f},t.defer=t.pending=function(){var n=new t(i);return n._setTrace(void 0),new et(n)},t.bind=function(n){var f=u(n,void 0),r=new t(i),e;return r._setTrace(void 0),f instanceof t?(e=f.then(function(n){r._setBoundTo(n)}),r._follow(e)):(r._setBoundTo(n),r._setFulfilled()),r},t.cast=function(n){var r=u(n,void 0),f;return r instanceof t||(f=r,r=new t(i),r._setTrace(void 0),r._setFulfilled(),r._cleanValues(),r._settledValue=f),r},t.resolve=t.fulfilled=t.cast,t.reject=t.rejected=function(n){var r=new t(i),u;return r._setTrace(void 0),ut(n),r._cleanValues(),r._setRejected(),r._settledValue=n,a(n)||(u=new Error(n+""),r._setCarriedStackTrace(u)),r._ensurePossibleRejectionHandled(),r},t.onPossiblyUnhandledRejection=function(n){o.possiblyUnhandledRejection=typeof n=="function"?n:void 0},t.onUnhandledRejectionHandled=function(n){nt=typeof n=="function"?n:void 0},e=!1||!!(typeof process!="undefined"&&typeof process.execPath=="string"&&typeof process.env=="object"&&(process.env.BLUEBIRD_DEBUG||process.env.NODE_ENV==="development")),t.longStackTraces=function(){if(s.haveItemsQueued()&&e===!1)throw new Error("cannot enable long stack traces after promises have been created");e=o.isSupported()},t.hasLongStackTraces=function(){return e&&o.isSupported()},t.prototype._then=function(n,r,u,f,o){var c=o!==void 0,h=c?o:new t(i),l,a;return c||(e&&(l=this._peekContext()===this._traceParent,h._traceParent=l?this._traceParent:this),h._propagateFrom(this,7)),a=this._addCallbacks(n,r,u,h,f),this.isResolved()&&s.invoke(this._queueSettleAt,this,a),h},t.prototype._length=function(){return this._bitField&262143},t.prototype._isFollowingOrFulfilledOrRejected=function(){return(this._bitField&939524096)>0},t.prototype._isFollowing=function(){return(this._bitField&536870912)==536870912},t.prototype._setLength=function(n){this._bitField=this._bitField&-262144|n&262143},t.prototype._setFulfilled=function(){this._bitField=this._bitField|268435456},t.prototype._setRejected=function(){this._bitField=this._bitField|134217728},t.prototype._setFollowing=function(){this._bitField=this._bitField|536870912},t.prototype._setIsFinal=function(){this._bitField=this._bitField|33554432},t.prototype._isFinal=function(){return(this._bitField&33554432)>0},t.prototype._cancellable=function(){return(this._bitField&67108864)>0},t.prototype._setCancellable=function(){this._bitField=this._bitField|67108864},t.prototype._unsetCancellable=function(){this._bitField=this._bitField&-67108865},t.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|2097152},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-2097153;this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(this._bitField&2097152)>0},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|524288},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-524289},t.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&524288)>0},t.prototype._setCarriedStackTrace=function(n){this._bitField=this._bitField|1048576;this._fulfillmentHandler0=n},t.prototype._unsetCarriedStackTrace=function(){this._bitField=this._bitField&-1048577;this._fulfillmentHandler0=void 0},t.prototype._isCarryingStackTrace=function(){return(this._bitField&1048576)>0},t.prototype._getCarriedStackTrace=function(){if(this._isCarryingStackTrace())return this._fulfillmentHandler0},t.prototype._receiverAt=function(n){var t=n===0?this._receiver0:this[(n<<2)+n-1];return this._isBound()&&t===void 0?this._boundTo:t},t.prototype._promiseAt=function(n){return n===0?this._promise0:this[(n<<2)+n-2]},t.prototype._fulfillmentHandlerAt=function(n){return n===0?this._fulfillmentHandler0:this[(n<<2)+n-5]},t.prototype._rejectionHandlerAt=function(n){return n===0?this._rejectionHandler0:this[(n<<2)+n-4]},t.prototype._addCallbacks=function(n,t,i,r,u){var f=this._length(),e;return f>=262138&&(f=0,this._setLength(0)),f===0?(this._promise0=r,u!==void 0&&(this._receiver0=u),typeof n!="function"||this._isCarryingStackTrace()||(this._fulfillmentHandler0=n),typeof t=="function"&&(this._rejectionHandler0=t),typeof i=="function"&&(this._progressHandler0=i)):(e=(f<<2)+f-5,this[e+3]=r,this[e+4]=u,this[e+0]=typeof n=="function"?n:void 0,this[e+1]=typeof t=="function"?t:void 0,this[e+2]=typeof i=="function"?i:void 0),this._setLength(f+1),f},t.prototype._setProxyHandlers=function(n,t){var i=this._length(),r;i>=262138&&(i=0,this._setLength(0));i===0?(this._promise0=t,this._receiver0=n):(r=(i<<2)+i-5,this[r+3]=t,this[r+4]=n,this[r+0]=this[r+1]=this[r+2]=void 0);this._setLength(i+1)},t.prototype._proxyPromiseArray=function(n,t){this._setProxyHandlers(n,t)},t.prototype._proxyPromise=function(n){n._setProxied();this._setProxyHandlers(n,-15)},t.prototype._setBoundTo=function(n){n!==void 0?(this._bitField=this._bitField|8388608,this._boundTo=n):this._bitField=this._bitField&-8388609},t.prototype._isBound=function(){return(this._bitField&8388608)==8388608},t.prototype._resolveFromResolver=function(n){function f(n){t._tryFollow(n)||t._fulfill(n)}function e(n){var i=a(n)?n:new Error(n+"");t._attachExtraTrace(i);ut(n);t._reject(n,i===n?void 0:i)}var t=this,r,i,u;this._setTrace(void 0);this._pushContext();r=it(n,void 0,f,e);this._popContext();r!==void 0&&r===d&&(i=r.e,u=a(i)?i:new Error(i+""),t._reject(i,u))},t.prototype._spreadSlowCase=function(n,t,i,r){var u=new f(i).promise(),e=u._then(function(){return n.apply(r,arguments)},void 0,void 0,k,void 0);t._follow(e)},t.prototype._callSpread=function(n,i,r){var e=this._boundTo,f,o;if(tt(r))for(f=0,o=r.length;f<o;++f)if(u(r[f],void 0)instanceof t){this._spreadSlowCase(n,i,r,e);return}return i._pushContext(),g(n,r,e)},t.prototype._callHandler=function(n,t,i,r){var u;return t!==k||this.isRejected()?(i._pushContext(),u=w(n,t,r)):u=this._callSpread(n,i,r),i._popContext(),u},t.prototype._settlePromiseFromHandler=function(n,i,r,f){var e,h,o,s;if(!(f instanceof t)){n.call(i,r,f);return}(e=this._callHandler(n,i,f,r),f._isFollowing())||(e===d||e===f||e===p?(h=e===f?b():e.e,s=a(h)?h:new Error(h+""),e!==p&&f._attachExtraTrace(s),f._rejectUnchecked(h,s)):(o=u(e,f),o instanceof t?(!o.isRejected()||o._isCarryingStackTrace()||a(o._settledValue)||(s=new Error(o._settledValue+""),f._attachExtraTrace(s),o._setCarriedStackTrace(s)),f._follow(o),f._propagateFrom(o,1)):f._fulfillUnchecked(e)))},t.prototype._follow=function(n){this._setFollowing();n.isPending()?(this._propagateFrom(n,1),n._proxyPromise(this)):n.isFulfilled()?this._fulfillUnchecked(n._settledValue):this._rejectUnchecked(n._settledValue,n._getCarriedStackTrace());n._isRejectionUnhandled()&&n._unsetRejectionIsUnhandled();e&&n._traceParent==null&&(n._traceParent=this)},t.prototype._tryFollow=function(n){if(this._isFollowingOrFulfilledOrRejected()||n===this)return!1;var i=u(n,void 0);return(i instanceof t)?(this._follow(i),!0):!1},t.prototype._resetTrace=function(){e&&(this._trace=new o(this._peekContext()===void 0))},t.prototype._setTrace=function(n){var t,i;return e&&(t=this._peekContext(),this._traceParent=t,i=t===void 0,this._trace=n!==void 0&&n._traceParent===t?n._trace:new o(i)),this},t.prototype._attachExtraTrace=function(n){var i,t,r,u;if(e){for(i=this,t=n.stack,t=typeof t=="string"?t.split("\n"):[],o.protectErrorMessageNewlines(t),r=1,u=1;i!=null&&i._trace!=null;)t=o.combine(t,i._trace.stack.split("\n")),i=i._traceParent,u++;var h=Error.stackTraceLimit||10,f=(h+r)*u,s=t.length;s>f&&(t.length=f);s>0&&(t[0]=t[0].split("\x02\x00\x01").join("\n"));n.stack=t.length<=r?"(No stack trace)":t.join("\n")}},t.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},t.prototype._propagateFrom=function(n,t){(t&1)>0&&n._cancellable()&&(this._setCancellable(),this._cancellationParent=n);(t&4)>0&&this._setBoundTo(n._boundTo);(t&2)>0&&this._setTrace(n)},t.prototype._fulfill=function(n){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(n)},t.prototype._reject=function(n,t){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(n,t)},t.prototype._settlePromiseAt=function(n){var s=this.isFulfilled()?this._fulfillmentHandlerAt(n):this._rejectionHandlerAt(n),r=this._settledValue,i=this._receiverAt(n),u=this._promiseAt(n),e,o;typeof s=="function"?this._settlePromiseFromHandler(s,i,r,u):(e=!1,o=this.isFulfilled(),i!==void 0&&(i instanceof t&&i._isProxied()?(i._unsetProxied(),o?i._fulfillUnchecked(r):i._rejectUnchecked(r,this._getCarriedStackTrace()),e=!0):i instanceof f&&(o?i._promiseFulfilled(r,u):i._promiseRejected(r,u),e=!0)),e||(o?u._fulfill(r):u._reject(r,this._getCarriedStackTrace())));n>=4&&this._queueGC()},t.prototype._isProxied=function(){return(this._bitField&4194304)==4194304},t.prototype._setProxied=function(){this._bitField=this._bitField|4194304},t.prototype._unsetProxied=function(){this._bitField=this._bitField&-4194305},t.prototype._isGcQueued=function(){return(this._bitField&-1073741824)==-1073741824},t.prototype._setGcQueued=function(){this._bitField=this._bitField|-1073741824},t.prototype._unsetGcQueued=function(){this._bitField=this._bitField&1073741823},t.prototype._queueGC=function(){this._isGcQueued()||(this._setGcQueued(),s.invokeLater(this._gc,this,void 0))},t.prototype._gc=function(){for(var t=this._length()*5-5,n=0;n<t;n++)delete this[n];this._clearFirstHandlerData();this._setLength(0);this._unsetGcQueued()},t.prototype._clearFirstHandlerData=function(){this._fulfillmentHandler0=void 0;this._rejectionHandler0=void 0;this._promise0=void 0;this._receiver0=void 0},t.prototype._queueSettleAt=function(n){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled();s.invoke(this._settlePromiseAt,this,n)},t.prototype._fulfillUnchecked=function(n){var t,i;if(this.isPending()){if(n===this)return t=b(),this._attachExtraTrace(t),this._rejectUnchecked(t,void 0);this._cleanValues();this._setFulfilled();this._settledValue=n;i=this._length();i>0&&s.invoke(this._settlePromises,this,i)}},t.prototype._rejectUncheckedCheckError=function(n){var t=a(n)?n:new Error(n+"");this._rejectUnchecked(n,t===n?void 0:t)},t.prototype._rejectUnchecked=function(n,t){var i,r;if(this.isPending()){if(n===this)return i=b(),this._attachExtraTrace(i),this._rejectUnchecked(i);if(this._cleanValues(),this._setRejected(),this._settledValue=n,this._isFinal()){s.invokeLater(lt,void 0,t===void 0?n:t);return}r=this._length();t!==void 0&&this._setCarriedStackTrace(t);r>0?s.invoke(this._rejectPromises,this,null):this._ensurePossibleRejectionHandled()}},t.prototype._rejectPromises=function(){this._settlePromises();this._unsetCarriedStackTrace()},t.prototype._settlePromises=function(){for(var t=this._length(),n=0;n<t;n++)this._settlePromiseAt(n)},t.prototype._ensurePossibleRejectionHandled=function(){this._setRejectionIsUnhandled();o.possiblyUnhandledRejection!==void 0&&s.invokeLater(this._notifyUnhandledRejection,this,void 0)},t.prototype._notifyUnhandledRejectionIsHandled=function(){typeof nt=="function"&&s.invokeLater(nt,void 0,this)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var n=this._settledValue,t=this._getCarriedStackTrace();this._setUnhandledRejectionIsNotified();t!==void 0&&(this._unsetCarriedStackTrace(),n=t);typeof o.possiblyUnhandledRejection=="function"&&o.possiblyUnhandledRejection(n,this)}},y=[],t.prototype._peekContext=function(){var n=y.length-1;if(n>=0)return y[n]},t.prototype._pushContext=function(){e&&y.push(this)},t.prototype._popContext=function(){e&&y.pop()},t.noConflict=function(){return r(t)},t.setScheduler=function(n){if(typeof n!="function")throw new l("fn must be a function");s._schedule=n},o.isSupported()||(t.longStackTraces=function(){},e=!1),t._makeSelfResolutionError=b,n("./finally.js")(t,p,u),n("./direct_resolve.js")(t),n("./synchronous_inspection.js")(t),n("./join.js")(t,f,u,i),t.RangeError=ot,t.CancellationError=st,t.TimeoutError=ht,t.TypeError=l,t.OperationalError=rt,t.RejectionError=rt,t.AggregateError=h.AggregateError,c.toFastProperties(t),c.toFastProperties(t.prototype),t.Promise=t,n("./timers.js")(t,i,u),n("./race.js")(t,i,u),n("./call_get.js")(t),n("./generators.js")(t,v,i,u),n("./map.js")(t,f,v,u,i),n("./nodeify.js")(t),n("./promisify.js")(t,i),n("./props.js")(t,f,u),n("./reduce.js")(t,f,v,u,i),n("./settle.js")(t,f),n("./some.js")(t,f,v),n("./progress.js")(t,f),n("./cancel.js")(t,i),n("./filter.js")(t,i),n("./any.js")(t,f),n("./each.js")(t,i),n("./using.js")(t,v,u),t.prototype=t.prototype,t}},{"./any.js":1,"./async.js":2,"./call_get.js":4,"./cancel.js":5,"./captured_trace.js":6,"./catch_filter.js":7,"./direct_resolve.js":8,"./each.js":9,"./errors.js":10,"./errors_api_rejection":11,"./filter.js":13,"./finally.js":14,"./generators.js":15,"./join.js":16,"./map.js":17,"./nodeify.js":18,"./progress.js":19,"./promise_array.js":21,"./promise_resolver.js":22,"./promisify.js":23,"./props.js":24,"./race.js":26,"./reduce.js":27,"./settle.js":29,"./some.js":30,"./synchronous_inspection.js":31,"./thenables.js":32,"./timers.js":33,"./using.js":34,"./util.js":35}],21:[function(n,t){"use strict";t.exports=function(t,i,r){function s(n){switch(n){case-1:return void 0;case-2:return[];case-3:return{}}}function u(n){var u=this._promise=new t(i),r=void 0;n instanceof t&&(r=n,u._propagateFrom(r,5));u._setTrace(r);this._values=n;this._length=0;this._totalResolved=0;this._init(void 0,-2)}var e=n("./errors.js").canAttach,o=n("./util.js"),f=o.isArray;return u.prototype.length=function(){return this._length},u.prototype.promise=function(){return this._promise},u.prototype._init=function h(n,i){var u=r(this._values,void 0),c,e,o;if(u instanceof t)if(this._values=u,u._setBoundTo(this._promise._boundTo),u.isFulfilled()){if(u=u._settledValue,!f(u)){c=new t.TypeError("expecting an array, a promise or a thenable");this.__hardReject__(c);return}}else{if(u.isPending()){u._then(h,this._reject,void 0,this,i);return}u._unsetRejectionIsUnhandled();this._reject(u._settledValue);return}else if(!f(u)){c=new t.TypeError("expecting an array, a promise or a thenable");this.__hardReject__(c);return}if(u.length===0){i===-5?this._resolveEmptyArray():this._resolve(s(i));return}var l=this.getActualLength(u.length),y=l,v=this.shouldCopyValues()?new Array(l):this._values,a=!1;for(e=0;e<l;++e)o=r(u[e],void 0),o instanceof t?o.isPending()?o._proxyPromiseArray(this,e):(o._unsetRejectionIsUnhandled(),a=!0):a=!0,v[e]=o;this._values=v;this._length=y;a&&this._scanDirectValues(l)},u.prototype._settlePromiseAt=function(n){var i=this._values[n];i instanceof t?i.isFulfilled()?this._promiseFulfilled(i._settledValue,n):i.isRejected()&&this._promiseRejected(i._settledValue,n):this._promiseFulfilled(i,n)},u.prototype._scanDirectValues=function(n){for(var t=0;t<n;++t){if(this._isResolved())break;this._settlePromiseAt(t)}},u.prototype._isResolved=function(){return this._values===null},u.prototype._resolve=function(n){this._values=null;this._promise._fulfill(n)},u.prototype.__hardReject__=u.prototype._reject=function(n){this._values=null;var t=e(n)?n:new Error(n+"");this._promise._attachExtraTrace(t);this._promise._reject(n,t)},u.prototype._promiseProgressed=function(n,t){this._isResolved()||this._promise._progress({index:t,value:n})},u.prototype._promiseFulfilled=function(n,t){if(!this._isResolved()){this._values[t]=n;var i=++this._totalResolved;i>=this._length&&this._resolve(this._values)}},u.prototype._promiseRejected=function(n){this._isResolved()||(this._totalResolved++,this._reject(n))},u.prototype.shouldCopyValues=function(){return!0},u.prototype.getActualLength=function(n){return n},u}},{"./errors.js":10,"./util.js":35}],22:[function(n,t){"use strict";function v(n){return n instanceof Error&&f.getPrototypeOf(n)===Error.prototype}function y(n){var t;return t=v(n)?new a(n):n,r.markAsOriginatingFromRejection(t),t}function e(n){function t(t,i){var u,f,e,r;if(n!==null){if(t)u=y(c(t)),n._attachExtraTrace(u),n._reject(u);else if(arguments.length>2){for(f=arguments.length,e=new Array(f-1),r=1;r<f;++r)e[r-1]=arguments[r];n._fulfill(e)}else n._fulfill(i);n=null}}return t}var s=n("./util.js"),c=s.maybeWrapAsError,r=n("./errors.js"),l=r.TimeoutError,a=r.OperationalError,u=n("./async.js"),h=s.haveGetters,f=n("./es5.js"),i,o;i=h?function(n){this.promise=n}:function(n){this.promise=n;this.asCallback=e(n);this.callback=this.asCallback};h&&(o={get:function(){return e(this.promise)}},f.defineProperty(i.prototype,"asCallback",o),f.defineProperty(i.prototype,"callback",o));i._nodebackForPromise=e;i.prototype.toString=function(){return"[object PromiseResolver]"};i.prototype.resolve=i.prototype.fulfill=function(n){if(!(this instanceof i))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");var t=this.promise;t._tryFollow(n)||u.invoke(t._fulfill,t,n)};i.prototype.reject=function(n){var t,f;if(!(this instanceof i))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");t=this.promise;r.markAsOriginatingFromRejection(n);f=r.canAttach(n)?n:new Error(n+"");t._attachExtraTrace(f);u.invoke(t._reject,t,n);f!==n&&u.invoke(this._setCarriedStackTrace,this,f)};i.prototype.progress=function(n){if(!(this instanceof i))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.");u.invoke(this.promise._progress,this.promise,n)};i.prototype.cancel=function(){u.invoke(this.promise.cancel,this.promise,void 0)};i.prototype.timeout=function(){this.reject(new l("timeout"))};i.prototype.isResolved=function(){return this.promise.isResolved()};i.prototype.toJSON=function(){return this.promise.toJSON()};i.prototype._setCarriedStackTrace=function(n){this.promise.isRejected()&&this.promise._setCarriedStackTrace(n)};t.exports=i},{"./async.js":2,"./errors.js":10,"./es5.js":12,"./util.js":35}],23:[function(n,t){"use strict";t.exports=function(t,i){function b(n){return n.replace(/([$])/,"\\$")}function o(n){try{return n.__isPromisified__===!0}catch(t){return!1}}function k(n,t,i){var u=r.getDataPropertyOrDefault(n,t+i,w);return u?o(u):!1}function d(n,t,i){for(var f,o,u,r=0;r<n.length;r+=2)if(f=n[r],i.test(f))for(o=f.replace(i,""),u=0;u<n.length;u+=2)if(n[u]===o)throw new e("Cannot promisify an API that has normal methods with '"+t+"'-suffix");}function g(n,t,i,u){for(var f,e,c=r.inheritedDataKeys(n),s=[],h=0;h<c.length;++h)f=c[h],e=n[f],typeof e!="function"||o(e)||k(n,f,t)||!u(f,e,n)||s.push(f,e);return d(s,t,i),s}function nt(n){for(var i=[n],r=Math.max(0,n-6),t=n-1;t>=r;--t)t!==n&&i.push(t);for(t=n+1;t<=5;++t)i.push(t);return i}function tt(n){return r.filledRange(n,"arguments[","]")}function it(n){return r.filledRange(n,"_arg","")}function rt(n){return typeof n.length=="number"?Math.max(Math.min(n.length,1024),0):0}function a(n){return r.isIdentifier(n)?"."+n:"['"+n.replace(/(['\\])/g,"\\$1")+"']"}function ut(n,f,e,o,s){function w(t){var r=tt(t).join(", "),e=t>0?", ":"",i;return i=typeof n=="string"?"                                                          \n                this.method({{args}}, fn);                                   \n                break;                                                       \n            ".replace(".method",a(n)):f===u?"                                                         \n                callback.call(this, {{args}}, fn);                           \n                break;                                                       \n            ":f!==void 0?"                                                         \n                callback.call(receiver, {{args}}, fn);                       \n                break;                                                       \n            ":"                                                         \n                callback({{args}}, fn);                                      \n                break;                                                       \n            ",i.replace("{{args}}",r).replace(", ",e)}function b(){for(var r,i="",t=0;t<v.length;++t)i+="case "+v[t]+":"+w(v[t]);return r=typeof n=="string"?"                                                  \n                this.property.apply(this, args);                             \n            ".replace(".property",a(n)):f===u?"                                                  \n                callback.apply(this, args);                                  \n            ":"                                                  \n                callback.apply(receiver, args);                              \n            ",i+"                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = fn;                                                    \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",r)}var y=Math.max(0,rt(o)-1),v=nt(y),p=typeof e=="string"&&r.isIdentifier(e)?e+s:"promisified";return new Function("Promise","callback","receiver","withAppended","maybeWrapAsError","nodebackForPromise","INTERNAL","                                         \n        var ret = function FunctionName(Parameters) {                        \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._setTrace(void 0);                                       \n            var fn = nodebackForPromise(promise);                            \n            try {                                                            \n                switch(len) {                                                \n                    [CodeForSwitchCase]                                      \n                }                                                            \n            } catch (e) {                                                    \n                var wrapped = maybeWrapAsError(e);                           \n                promise._attachExtraTrace(wrapped);                          \n                promise._reject(wrapped);                                    \n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        ret.__isPromisified__ = true;                                        \n        return ret;                                                          \n        ".replace("FunctionName",p).replace("Parameters",it(y)).replace("[CodeForSwitchCase]",b()))(t,n,f,c,l,h,i)}function ft(n,r){function f(){var e=r,f,s,o;r===u&&(e=this);typeof n=="string"&&(n=e[n]);f=new t(i);f._setTrace(void 0);s=h(f);try{n.apply(e,c(arguments,s))}catch(a){o=l(a);f._attachExtraTrace(o);f._reject(o)}return f}return f.__isPromisified__=!0,f}function s(n,t,i,e){for(var l=new RegExp(b(t)+"$"),s=g(n,t,l,i),o=0,a=s.length;o<a;o+=2){var h=s[o],c=s[o+1],v=h+t;n[v]=e===f?f(h,u,h,c,t):e(c)}return r.toFastProperties(n),n}function et(n,t){return f(n,t,void 0,n)}var u={},r=n("./util.js"),h=n("./promise_resolver.js")._nodebackForPromise,c=r.withAppended,l=r.maybeWrapAsError,v=r.canEvaluate,e=n("./errors").TypeError,y="Async",p=function(n,t){return r.isIdentifier(n)&&n.charAt(0)!=="_"&&!r.isClass(t)},w={__isPromisified__:!0},f=v?ut:ft;t.promisify=function(n,t){if(typeof n!="function")throw new e("fn must be a function");return o(n)?n:et(n,arguments.length<2?u:t)};t.promisifyAll=function(n,t){var i,u,o,c,h,l;if(typeof n!="function"&&typeof n!="object")throw new e("the target of promisifyAll must be an object or a function");if(t=Object(t),i=t.suffix,typeof i!="string"&&(i=y),u=t.filter,typeof u!="function"&&(u=p),o=t.promisifier,typeof o!="function"&&(o=f),!r.isIdentifier(i))throw new RangeError("suffix must be a valid identifier");for(c=r.inheritedDataKeys(n,{includeHidden:!0}),h=0;h<c.length;++h)l=n[c[h]],c[h]!=="constructor"&&r.isClass(l)&&(s(l.prototype,i,u,o),s(l,i,u,o));return s(n,i,u,o)}}},{"./errors":10,"./promise_resolver.js":22,"./util.js":35}],24:[function(n,t){"use strict";t.exports=function(t,i,r){function u(n){for(var u,f=h.keys(n),i=f.length,r=new Array(i*2),t=0;t<i;++t)u=f[t],r[t]=n[u],r[t+i]=u;this.constructor$(r)}function e(n){var f,i=r(n,void 0);if(s(i))f=i instanceof t?i._then(t.props,void 0,void 0,void 0,void 0):new u(i).promise();else return o("cannot await properties of a non-object");return i instanceof t&&f._propagateFrom(i,4),f}var f=n("./util.js"),o=n("./errors_api_rejection")(t),s=f.isObject,h=n("./es5.js");f.inherits(u,i);u.prototype._init=function(){this._init$(void 0,-3)};u.prototype._promiseFulfilled=function(n,t){var u,r,f,i,e;if(!this._isResolved()&&(this._values[t]=n,u=++this._totalResolved,u>=this._length)){for(r={},f=this.length(),i=0,e=this.length();i<e;++i)r[this._values[i+f]]=this._values[i];this._resolve(r)}};u.prototype._promiseProgressed=function(n,t){this._isResolved()||this._promise._progress({key:this._values[t+this.length()],value:n})};u.prototype.shouldCopyValues=function(){return!1};u.prototype.getActualLength=function(n){return n>>1};t.prototype.props=function(){return e(this)};t.props=function(n){return e(n)}}},{"./errors_api_rejection":11,"./es5.js":12,"./util.js":35}],25:[function(n,t){"use strict";function r(n,t,i,r,u){for(var f=0;f<u;++f)i[f+r]=n[f+t]}function i(n){this._capacity=n;this._length=0;this._front=0;this._makeCapacity()}i.prototype._willBeOverCapacity=function(n){return this._capacity<n};i.prototype._pushOne=function(n){var t=this.length(),i;this._checkCapacity(t+1);i=this._front+t&this._capacity-1;this[i]=n;this._length=t+1};i.prototype.push=function(n,t,i){var r=this.length()+3,u,f;if(this._willBeOverCapacity(r)){this._pushOne(n);this._pushOne(t);this._pushOne(i);return}u=this._front+r-3;this._checkCapacity(r);f=this._capacity-1;this[u+0&f]=n;this[u+1&f]=t;this[u+2&f]=i;this._length=r};i.prototype.shift=function(){var n=this._front,t=this[n];return this[n]=void 0,this._front=n+1&this._capacity-1,this._length--,t};i.prototype.length=function(){return this._length};i.prototype._makeCapacity=function(){for(var t=this._capacity,n=0;n<t;++n)this[n]=void 0};i.prototype._checkCapacity=function(n){this._capacity<n&&this._resizeTo(this._capacity<<3)};i.prototype._resizeTo=function(n){var i=this._front,u=this._capacity,f=new Array(u),t=this.length(),e;r(this,0,f,0,u);this._capacity=n;this._makeCapacity();this._front=0;i+t<=u?r(f,i,this,0,t):(e=t-(i+t&u-1),r(f,i,this,0,e),r(f,0,this,e,t-e))};t.exports=i},{}],26:[function(n,t){"use strict";t.exports=function(t,i,r){function u(n,u){var a=r(n,void 0),h,v,y,c,p,l;if(a instanceof t)return o(a);if(!e(n))return f("expecting an array, a promise or a thenable");for(h=new t(i),u!==void 0?h._propagateFrom(u,7):h._setTrace(void 0),v=h._fulfill,y=h._reject,c=0,p=n.length;c<p;++c)(l=n[c],l!==void 0||s.call(n,c))&&t.cast(l)._then(v,y,void 0,h,null);return h}var f=n("./errors_api_rejection.js")(t),e=n("./util.js").isArray,o=function(n){return n.then(function(t){return u(t,n)})},s={}.hasOwnProperty;t.race=function(n){return u(n,void 0)};t.prototype.race=function(){return u(this,void 0)}}},{"./errors_api_rejection.js":11,"./util.js":35}],27:[function(n,t){"use strict";t.exports=function(t,i,r,u,f){function e(n,i,r,e){this.constructor$(n);this._preservedValues=e===f?[]:null;this._zerothIsAccum=r===void 0;this._gotAccum=!1;this._reducingIndex=this._zerothIsAccum?1:0;this._valuesPhase=undefined;var o=u(r,void 0),s=!1,h=o instanceof t;h&&(o.isPending()?o._proxyPromiseArray(this,-1):o.isFulfilled()?(r=o.value(),this._gotAccum=!0):(o._unsetRejectionIsUnhandled(),this._reject(o.reason()),s=!0));h||this._zerothIsAccum||(this._gotAccum=!0);this._callback=i;this._accum=r;s||this._init$(void 0,-5)}function s(n,t,i,u){if(typeof t!="function")return r("fn must be a function");var f=new e(n,t,i,u);return f.promise()}var o=n("./util.js"),h=o.tryCatch4,c=o.tryCatch3,l=o.errorObj;o.inherits(e,i);e.prototype._init=function(){};e.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(this._preservedValues!==null?[]:this._accum)};e.prototype._promiseFulfilled=function(n,i){var b=this._values,p,w,s,r,o;if(b!==null){var a=this.length(),y=this._preservedValues,k=y!==null,v=this._gotAccum,e=this._valuesPhase,f;if(!e)for(e=this._valuesPhase=Array(a),f=0;f<a;++f)e[f]=0;if(f=e[i],i===0&&this._zerothIsAccum?(v||(this._accum=n,this._gotAccum=v=!0),e[i]=f===0?1:2):i===-1?v||(this._accum=n,this._gotAccum=v=!0):f===0?e[i]=1:(e[i]=2,v&&(this._accum=n)),v){for(p=this._callback,w=this._promise._boundTo,r=this._reducingIndex;r<a;++r){if(f=e[r],f===2){this._reducingIndex=r+1;continue}if(f!==1)return;if(n=b[r],n instanceof t)if(n.isFulfilled())n=n._settledValue;else return n.isPending()?void 0:(n._unsetRejectionIsUnhandled(),this._reject(n.reason()));if(k?(y.push(n),s=c(p,w,n,r,a)):s=h(p,w,this._accum,n,r,a),s===l)return this._reject(s.e);if(o=u(s,void 0),o instanceof t){if(o.isPending())return e[r]=4,o._proxyPromiseArray(this,r);if(o.isFulfilled())s=o.value();else return o._unsetRejectionIsUnhandled(),this._reject(o.reason())}this._reducingIndex=r+1;this._accum=s}this._reducingIndex<a||this._resolve(k?y:this._accum)}}};t.prototype.reduce=function(n,t){return s(this,n,t,null)};t.reduce=function(n,t,i,r){return s(n,t,i,r)}}},{"./util.js":35}],28:[function(n,t){"use strict";var i,r;if(typeof process=="object"&&typeof process.version=="string")i=function(n){process.nextTick(n)};else if(typeof MutationObserver!="undefined"&&(r=MutationObserver)||typeof WebKitMutationObserver!="undefined"&&(r=WebKitMutationObserver))i=function(){var t=document.createElement("div"),n=void 0,i=new r(function(){var t=n;n=void 0;t()});return i.observe(t,{attributes:!0}),function(i){n=i;t.classList.toggle("foo")}}();else if(typeof setTimeout!="undefined")i=function(n){setTimeout(n,0)};else throw new Error("no async scheduler available");t.exports=i},{}],29:[function(n,t){"use strict";t.exports=function(t,i){function r(n){this.constructor$(n)}var u=t.PromiseInspection,f=n("./util.js");f.inherits(r,i);r.prototype._promiseResolved=function(n,t){this._values[n]=t;var i=++this._totalResolved;i>=this._length&&this._resolve(this._values)};r.prototype._promiseFulfilled=function(n,t){if(!this._isResolved()){var i=new u;i._bitField=268435456;i._settledValue=n;this._promiseResolved(t,i)}};r.prototype._promiseRejected=function(n,t){if(!this._isResolved()){var i=new u;i._bitField=134217728;i._settledValue=n;this._promiseResolved(t,i)}};t.settle=function(n){return new r(n).promise()};t.prototype.settle=function(){return new r(this).promise()}}},{"./util.js":35}],30:[function(n,t){"use strict";t.exports=function(t,i,r){function u(n){this.constructor$(n);this._howMany=0;this._unwrap=!1;this._initialized=!1}function e(n,t){if((t|0)!==t||t<0)return r("expecting a positive integer");var i=new u(n),f=i.promise();return f.isRejected()?f:(i.setHowMany(t),i.init(),f)}var f=n("./util.js"),o=n("./errors.js").RangeError,s=n("./errors.js").AggregateError,h=f.isArray;f.inherits(u,i);u.prototype._init=function(){if(this._initialized){if(this._howMany===0){this._resolve([]);return}this._init$(void 0,-5);var n=h(this._values);!this._isResolved()&&n&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}};u.prototype.init=function(){this._initialized=!0;this._init()};u.prototype.setUnwrap=function(){this._unwrap=!0};u.prototype.howMany=function(){return this._howMany};u.prototype.setHowMany=function(n){this._isResolved()||(this._howMany=n)};u.prototype._promiseFulfilled=function(n){this._isResolved()||(this._addFulfilled(n),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values)))};u.prototype._promiseRejected=function(n){var i,t;if(!this._isResolved()&&(this._addRejected(n),this.howMany()>this._canPossiblyFulfill())){for(i=new s,t=this.length();t<this._values.length;++t)i.push(this._values[t]);this._reject(i)}};u.prototype._fulfilled=function(){return this._totalResolved};u.prototype._rejected=function(){return this._values.length-this.length()};u.prototype._addRejected=function(n){this._values.push(n)};u.prototype._addFulfilled=function(n){this._values[this._totalResolved++]=n};u.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()};u.prototype._getRangeError=function(n){var t="Input array must contain at least "+this._howMany+" items but contains only "+n+" items";return new o(t)};u.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))};t.some=function(n,t){return e(n,t)};t.prototype.some=function(n){return e(this,n)};t._SomePromiseArray=u}},{"./errors.js":10,"./util.js":35}],31:[function(n,t){"use strict";t.exports=function(n){function t(n){n!==void 0?(this._bitField=n._bitField,this._settledValue=n.isResolved()?n._settledValue:void 0):(this._bitField=0,this._settledValue=void 0)}t.prototype.isFulfilled=n.prototype.isFulfilled=function(){return(this._bitField&268435456)>0};t.prototype.isRejected=n.prototype.isRejected=function(){return(this._bitField&134217728)>0};t.prototype.isPending=n.prototype.isPending=function(){return(this._bitField&402653184)==0};t.prototype.value=n.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise");return this._settledValue};t.prototype.error=t.prototype.reason=n.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise");return this._settledValue};t.prototype.isResolved=n.prototype.isResolved=function(){return(this._bitField&402653184)>0};n.PromiseInspection=t}},{}],32:[function(n,t){"use strict";t.exports=function(t,i){function o(n){try{return n.then}catch(t){return u.e=t,u}}function s(n,f){var s,h;if(e(n)){if(n instanceof t)return n;if(c(n))return s=new t(i),s._setTrace(void 0),n._then(s._fulfillUnchecked,s._rejectUncheckedCheckError,s._progressUnchecked,s,null),s._setFollowing(),s;if(h=o(n),h===u)return f!==void 0&&r(h.e)&&f._attachExtraTrace(h.e),t.reject(h.e);if(typeof h=="function")return l(n,h,f)}return n}function c(n){return h.call(n,"_promise0")}function l(n,i,u){function h(i){if(!f){if(f=!0,n===i){var r=t._makeSelfResolutionError();u!==void 0&&u._attachExtraTrace(r);e.promise._reject(r,void 0);return}e.resolve(i)}}function c(n){if(!f){f=!0;var t=r(n)?n:new Error(n+"");u!==void 0&&u._attachExtraTrace(t);e.promise._reject(n,t)}}function l(n){if(!f){var t=e.promise;typeof t._progress=="function"&&t._progress(n)}}var e=t.defer(),f=!1,s;try{i.call(n,h,c,l)}catch(o){f||(f=!0,s=r(o)?o:new Error(o+""),u!==void 0&&u._attachExtraTrace(s),e.promise._reject(o,s))}return e.promise}var f=n("./util.js"),r=n("./errors.js").canAttach,u=f.errorObj,e=f.isObject,h={}.hasOwnProperty;return s}},{"./errors.js":10,"./util.js":35}],33:[function(n,t){"use strict";var i=function(n,t){var i=arguments.length,r=arguments[2],u=arguments[3],f=i>=5?arguments[4]:void 0;setTimeout(function(){n(r,u,f)},t|0)};t.exports=function(t,r,u){var c=n("./util.js"),f=n("./errors.js"),l=n("./errors_api_rejection")(t),e=t.TimeoutError,o=function(n,t,i){if(n.isPending()){typeof t!="string"&&(t="operation timed out after "+i+" ms");var r=new e(t);f.markAsOriginatingFromRejection(r);n._attachExtraTrace(r);n._cancel(r)}},s=function(n,t){t._fulfill(n)},h=t.delay=function(n,f){f===void 0&&(f=n,n=void 0);f=+f;var o=u(n,void 0),e=new t(r);return o instanceof t?(e._propagateFrom(o,7),e._follow(o),e.then(function(n){return t.delay(n,f)})):(e._setTrace(void 0),i(s,f,n,e),e)};t.prototype.delay=function(n){return h(this,n)};t.prototype.timeout=function(n,u){n=+n;var f=new t(r);return f._propagateFrom(this,7),f._follow(this),i(o,n,f,u,n),f.cancellable()}}},{"./errors.js":10,"./errors_api_rejection":11,"./util.js":35}],34:[function(n,t){"use strict";t.exports=function(t,i,r){function l(n){for(var r,u=n.length,i=0;i<u;++i){if(r=n[i],r.isRejected())return t.reject(r.error());n[i]=r.value()}return n}function o(n){setTimeout(function(){throw n;},0)}function a(n){var t=r(n,void 0);return t!==n&&typeof n._isDisposable=="function"&&typeof n._getDisposer=="function"&&n._isDisposable()&&t._setDisposable(n._getDisposer()),t}function s(n,i){function u(){if(f>=s)return e.resolve();var h=a(n[f++]);if(h instanceof t&&h._isDisposable()){try{h=r(h._getDisposer().tryDispose(i),void 0)}catch(c){return o(c)}if(h instanceof t)return h._then(u,o,null,null,null)}u()}var f=0,s=n.length,e=t.defer();return u(),e.promise}function v(n){var t=new e;return t._settledValue=n,t._bitField=268435456,s(this,t).thenReturn(n)}function y(n){var t=new e;return t._settledValue=n,t._bitField=134217728,s(this,t).thenThrow(n)}function u(n,t){this._data=n;this._promise=t}function f(n,t){this.constructor$(n,t)}var h=n("./errors.js").TypeError,c=n("./util.js").inherits,e=t.PromiseInspection;u.prototype.data=function(){return this._data};u.prototype.promise=function(){return this._promise};u.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null};u.prototype.tryDispose=function(n){var t=this.resource(),i=t!==null?this.doDispose(t,n):null;return this._promise._unsetDisposable(),this._data=this._promise=null,i};u.isDisposer=function(n){return n!=null&&typeof n.resource=="function"&&typeof n.tryDispose=="function"};c(f,u);f.prototype.doDispose=function(n,t){var i=this.data();return i.call(n,n,t)};t.using=function(){var r=arguments.length,o,e,f,n,s;if(r<2)return i("you must pass at least 2 arguments to Promise.using");if(o=arguments[r-1],typeof o!="function")return i("fn must be a function");for(r--,e=new Array(r),f=0;f<r;++f)n=arguments[f],u.isDisposer(n)&&(s=n,n=n.promise(),n._setDisposable(s)),e[f]=n;return t.settle(e).then(l).spread(o)._then(v,y,void 0,e,void 0)};t.prototype._setDisposable=function(n){this._bitField=this._bitField|262144;this._disposer=n};t.prototype._isDisposable=function(){return(this._bitField&262144)>0};t.prototype._getDisposer=function(){return this._disposer};t.prototype._unsetDisposable=function(){this._bitField=this._bitField&-262145;this._disposer=void 0};t.prototype.disposer=function(n){if(typeof n=="function")return new f(n,this);throw new h;}}},{"./errors.js":10,"./util.js":35}],35:[function(n,t){"use strict";function s(n,t,r){try{return n.call(t,r)}catch(u){return i.e=u,i}}function h(n,t,r,u){try{return n.call(t,r,u)}catch(f){return i.e=f,i}}function c(n,t,r,u,f){try{return n.call(t,r,u,f)}catch(e){return i.e=e,i}}function l(n,t,r,u,f,e){try{return n.call(t,r,u,f,e)}catch(o){return i.e=o,i}}function a(n,t,r){try{return n.apply(r,t)}catch(u){return i.e=u,i}}function f(n){return typeof n=="string"?n:""+n}function u(n){return n==null||n===!0||n===!1||typeof n=="string"||typeof n=="number"}function y(n){return!u(n)}function p(n){return u(n)?new Error(f(n)):n}function w(n,t){for(var u=n.length,r=new Array(u+1),i=0;i<u;++i)r[i]=n[i];return r[i]=t,r}function b(n,t,i){if(r.isES5){var u=Object.getOwnPropertyDescriptor(n,t);if(u!=null)return u.get==null&&u.set==null?u.value:i}else return{}.hasOwnProperty.call(n,t)?n[t]:void 0}function k(n,t,i){if(u(n))return n;var f={value:i,configurable:!0,enumerable:!1,writable:!0};return r.defineProperty(n,t,f),n}function g(n){throw n;}function tt(n){try{if(typeof n=="function"){var t=r.keys(n.prototype);return t.length>0&&!(t.length===1&&t[0]==="constructor")}return!1}catch(i){return!1}}function it(obj){function f(){}return f.prototype=obj,f}function ut(n){return rt.test(n)}function ft(n,t,i){for(var u=new Array(n),r=0;r<n;++r)u[r]=t+r+i;return u}var r=n("./es5.js"),e=function(){try{var n={};return r.defineProperty(n,"f",{get:function(){return 3}}),n.f===3}catch(t){return!1}}(),o=typeof navigator=="undefined",i={e:{}},v=function(n,t){function i(){this.constructor=n;this.constructor$=t;for(var i in t.prototype)r.call(t.prototype,i)&&i.charAt(i.length-1)!=="$"&&(this[i+"$"]=t.prototype[i])}var r={}.hasOwnProperty;return i.prototype=t.prototype,n.prototype=new i,n.prototype},d=function(){return this!=="string"}.call("string"),nt=function(){return r.isES5?function(n,t){for(var e=[],s=Object.create(null),h=Object(t).includeHidden?Object.getOwnPropertyNames:Object.keys,o,u,i,f;n!=null;){try{o=h(n)}catch(c){return e}for(u=0;u<o.length;++u)(i=o[u],s[i])||(s[i]=!0,f=Object.getOwnPropertyDescriptor(n,i),f!=null&&f.get==null&&f.set==null&&e.push(i));n=r.getPrototypeOf(n)}return e}:function(n){var t=[];for(var i in n)t.push(i);return t}}(),rt=/^[a-z$_][a-z$_0-9]*$/i,et={isClass:tt,isIdentifier:ut,inheritedDataKeys:nt,getDataPropertyOrDefault:b,thrower:g,isArray:r.isArray,haveGetters:e,notEnumerableProp:k,isPrimitive:u,isObject:y,canEvaluate:o,errorObj:i,tryCatch1:s,tryCatch2:h,tryCatch3:c,tryCatch4:l,tryCatchApply:a,inherits:v,withAppended:w,asString:f,maybeWrapAsError:p,wrapsPrimitiveReceiver:d,toFastProperties:it,filledRange:ft};t.exports=et},{"./es5.js":12}]},{},[3])(3)});typeof window!="undefined"&&window!==null?window.P=window.Promise:typeof self!="undefined"&&self!==null&&(self.P=self.Promise);
/*
//# sourceMappingURL=bluebird.min.js.map
*/